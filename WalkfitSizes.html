
<style>
    .select-button {
        padding: 10px;
        margin: 10px 5px 5px;
        display: block;
        cursor: pointer;
        text-decoration: none;
        text-align: center;
        vertical-align: middle;
        border: 1px solid #D9D9D9;
        width: 95%;
        background-color: #FFF;
        font-size: 20px;
        font-family: Lato, sans-serif;
        line-height: inherit;
        font-weight: 700;
        font-style: inherit;
        color: #000;
        text-transform: inherit;
        border-radius: 9px;
    }

    .select-button:hover {
        background: #A9CFF9;
    }

    .select-button.active {
        background: #A9CFF9;
    }

    .widget-text-cs {
        margin: 20px 0 5px 10px;
        font-size: 24px;
        font-family: Lato, sans-serif;
        text-align: inherit;
        line-height: inherit;
        font-weight: 700;
        font-style: inherit;
    }

    .add-btn a {
        cursor: default;
        border: 1px solid #D9D9D9;
        color: #000000 !important;
        border-radius: 9px;
    }

    .add-btn a.active {
        cursor: pointer;
        border: none;
        color: #FFF !important;
        background: #3175C1 !important;
    }

    .selectQBottom {
        font-size: 22px;
        border: 3px solid #9CADB5;
        background: #fff;
        width: 80px;
        height: 40px;
        margin: 7px auto;
        display: inline-block;
    }

    @media only screen and (max-width: 1060px) {
        .selectQBottom {
            font-size: 22px;
            width: 50px;
            height: 35px;
        }
    }

    .item-box {
        border: 1px solid #dee4e6;
        padding: 10px;
    }

    .item-box .widget-text {
        font-size: 20px;
        margin: 10px 0;
    }

    .item-box .item-price {
        font-size: 22px;
        font-weight: 500;
        margin: 10px 0;
    }

    .item-box .item-quantity {
        float: left;
        padding: 3px 10px 0 0;
    }

    .item-box .item-remove {
        text-align: end;
        font-weight: 500;
        color: #0066b1;
        cursor: pointer;
    }

</style>
<div class="widget-text-cs">Select Type</div>
<div class="grid">
    <div class="grid__row">
        <div class="grid__column area--6">
            <div class="grid__cell">
                <button data-type="women" class="select-button">Women's</button>
            </div>
        </div>
        <div class="grid__column area--6">
            <div class="grid__cell">
                <button data-type="men" class="select-button">Men's</button>
            </div>
        </div>
    </div>
</div>
<div class="widget-text-cs">Select Size</div>
<div class="grid" data-gender="women">
    <div class="grid__row">
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="5" class="select-button">5 - 5.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="6" class="select-button">6 - 6.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="7" class="select-button">7 - 7.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="8" class="select-button">8 - 8.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="9" class="select-button">9 - 9.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="10" class="select-button">10 - 10.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="11" class="select-button">11 - 11.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="12" class="select-button">12 - 12.5</button>
            </div>
        </div>
    </div>
</div>
<div class="grid" data-gender="men" style="display:none">
    <div class="grid__row">
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="6" class="select-button">6 - 6.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="7" class="select-button">7 - 7.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="8" class="select-button">8 - 8.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="9" class="select-button">9 - 9.5</button>
            </div>
        </div>
        <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="10" class="select-button">10 - 10.5</button>
            </div>
        </div>
         <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="11" class="select-button">11 - 11.5</button>
            </div>
        </div>
         <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="12" class="select-button">12 - 12.5</button>
            </div>
        </div>
         <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="13" class="select-button">13 - 13.5</button>
            </div>
        </div>
         <div class="grid__column area--4">
            <div class="grid__cell">
                <button data-size="14" class="select-button">14 - 14.5</button>
            </div>
        </div>
    </div>
</div>

	</div>
	
  


</body>
</html>

<script type="text/javascript">


var currentItems = [];
var currentItem = {
  id: 0,
  type: '',
  size: '',
  quantity: 1
};
$('.hidden-block').hide();
addNewItem();

$('button[data-type="women"]').click(function() {
  if (!$(this).hasClass('active')) {
    $(this).addClass('active');
    $('button[data-type="men"]').removeClass('active');
    $('div[data-gender="women"]').show();
    $('div[data-gender="men"]').hide();
    if (currentItem.type === 'Men') {
      currentItem.size = '';
    }
    currentItem.type = 'Women';
    toggleAddToCart();
  }
});

$('button[data-type="men"]').click(function() {
  if (!$(this).hasClass('active')) {
    $(this).addClass('active');
    $('button[data-type="women"]').removeClass('active');
    $('div[data-gender="men"]').show();
    $('div[data-gender="women"]').hide();
    if (currentItem.type === 'Women') {
      currentItem.size = '';
    }
    currentItem.type = 'Men';
    toggleAddToCart();
  }
});

$('button[data-size]').click(function() {
  $('button[data-size]').removeClass('active');
  $(this).addClass('active');
  currentItem.size = $(this).attr('data-size');
  toggleAddToCart();
});

$('.add-btn a').click(function() {
  if ($(this).hasClass('active')) {
    currentItem.id = new Date().getTime();
    currentItems.push(Object.assign({}, currentItem));
    addNewItem(currentItem);
    renderDropDowns();
    renderAddToCart();
  }
});

$('#selectQ').change(function() {
  currentItem.quantity = Number($(this).val());
});

$('body').on('change', '.selectQBottom', function() {
  var id = $(this).closest('[data-id]').attr('data-id');
  var val = Number($(this).val());
  var priceEl = $(this).closest('.grid__cell').find('.item-price');
  currentItems.forEach(function(el, i) {
    if (el.id === Number(id)) {
      el.quantity = val;
      var price = i === 0 ?
        `$${(14.95 * el.quantity).toFixed(2)} + S&P` :
        `$${(14.95 * el.quantity).toFixed(2)} + FREE S&P`;
      priceEl.text(price);
    }
  });

  reRenderQDropDown();
  renderDropDowns();
  renderAddToCart();
});

$('body').on('click', '.item-remove', function() {
  var id = Number($(this).attr('data-remove'));
  currentItems = currentItems.filter(function(el) {
    return el.id !== id;
  });
  reRenderQDropDown();
  renderDropDowns();
  renderAddToCart();
  $(this).closest('[data-id]').remove();
});

function toggleAddToCart() {
  var addToCartBtn = $('.add-btn a');
  if (currentItem.type !== '' && currentItem.size !== '') {
    addToCartBtn.addClass('active');
  }
  else {
    addToCartBtn.removeClass('active');
  }
}

function addNewItem(currentItem) {
  var quantity = getCurrentQuantity();
  var cartWr = $('.cart-wr > div');
  if (currentItem) {
    var isFirstPair = currentItems.length === 1;
    var price = isFirstPair ?
      `$${(14.95 * currentItem.quantity).toFixed(2)} + S&P` :
      `$${(14.95 * currentItem.quantity).toFixed(2)} + FREE S&P`;
    cartWr.append('<div class="grid__row item-box" data-id="' + currentItem.id + '"><div class="grid__column area--12"><div class="grid__cell"><div class="grid__row grid__row--forever"> <div class="grid__column area--7"> <div class="grid__cell"> <div> <div class="widget-text item-price">' + price + '</div></div>    <div>    <div class="widget-text item-size">Size: ' + currentItem.type + 'â€™s ' + `${currentItem.size - 1.5} - ${currentItem.size}` + '</div>    </div>    <div>    <div class="widget-text item-quantity">Quantity:</div> <select id="' + currentItem.id + '" class="selectQBottom"></select> </div> </div> </div> <div class="grid__column area--5"> <div class="grid__cell"> <div class="widget-text item-remove" data-remove="' + currentItem.id + '">Remove <i class="fas fa-times"    style="margin-left: 5px; vertical-align: middle;"></i> </div> </div> </div> </div> </div> </div> </div>');
    var options = '';
    for (var i = 1; i <= currentItem.quantity; i++) {
      options += '<option value="' + i + '">' + i + '</option>';
    }
    $('#' + currentItem.id).html(options).find('option').eq(currentItem.quantity - 1).attr('selected', 'selected');

    currentItem.quantity = 1;
  }
  reRenderQDropDown();
}

function getCurrentQuantity() {
  var quantity = 0;
  currentItems.forEach(function(i) {
    quantity += i.quantity;
  });
  return quantity;
}

function renderDropDowns() {
  var maxQuantity = 3 - getCurrentQuantity();
  $('.selectQBottom').each(function(i, el) {
    var currentValue = Number($(el).val());

    $(el).find('option').each(function() {
      if (Number($(this).val()) > currentValue) {
        $(this).remove();
      }
    });
    for (var j = currentValue + 1; j <= currentValue + maxQuantity; j++) {
      $(el).append('<option value="' + j + '">' + j + '</option>');
    }
  });
}

function reRenderQDropDown() {
  var quantity = getCurrentQuantity();
  var optionsQ = '';
  for (var j = 1; j <= 3 - quantity; j++) {
    optionsQ += '<option value="' + j + '">' + j + '</option>';
  }
  if (optionsQ === '') {
    optionsQ = '<option value="0"> - </option>';
  }
  $('#selectQ').html(optionsQ).find('option').eq(0).attr('selected', 'selected');
}

function renderAddToCart() {
  var addToCartBtn = $('.add-btn a');
  var quantity = getCurrentQuantity();
  if (quantity >= 3) {
    addToCartBtn.removeClass('active');
  } else {
    addToCartBtn.addClass('active');
  }
  if (currentItems.length > 0) {
    addToCartBtn.text('ADD AN ADDITIONAL PAIR');
  }
  else {
    addToCartBtn.text('ADD TO CART');
  }

  if (quantity === 0) {
    $('.hidden-block').hide();
  }
  else {
    $('.hidden-block').show();
  }
  $('.cart-items-wr').text('YOUR SHOPPING CART (' + quantity + ' ITEMS)');
}

if (typeof window.mojoApp !== 'undefined') {
  window.mojoApp._hooks.add('upsell_form_send_offers_filter', function(value, options) {
      function getOfferId(current, isFirstOffer = false) {
        return ___pageOffers.filter(function(el) {
          return isFirstOffer 
            ? el.name.indexOf('-' + current.size) > -1 && el.name.indexOf(current.type) > -1 && el.shippingPrice > 0
            : el.name.indexOf('-' + current.size) > -1 && el.name.indexOf(current.type) > -1 && el.shippingPrice === 0;
        })[0];
      }

      for (var o in options) {
        options[o] = 0;
      }

      currentItems.forEach(function(el, index) {
        var offer = getOfferId(el, index === 0);
        options[offer.offerId] = el.quantity;
      });
      return options;
    }
  );
}


</script>